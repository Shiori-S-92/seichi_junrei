<!--<h1>Public::Posts#show</h1>-->
<!--<p>Find me in app/views/public/posts/show.html.erb</p>-->

<div class="container">
  <div class="row">
    <h1>投稿詳細</h1>
  </div>

  <div class="row">
    <div class="col-md-5">
      <div class="slider">
        <% if @post.images.present? %>
          <% @post.images.each do |image| %>
            <div style="width:100%">
              <%= image_tag image, style: 'width:100%; height: 400px; object-fit:contain; text-align: center;',alt: '@post iamge' %>
            </div>
          <% end %>
        <% end %>
      </div>
      <p><%= link_to @post.user.name, user_path(@post.user.id) %></p>
      <p><%= @post.created_at.to_s(:datetime_jp) %></p>
      <br>
      <p>〒<%= @post.postal_code.to_s.insert(3, "-") %></p>
      <p><%= @post.address %></p>
    </div>

    <div class="col-md-6 offset-md-1">
      <h3><b><%= @post.title %></b></h3>
      <p><%= @post.content %></p>
      <h5>コメント</h5>
      <table class='jscroll-div'>
        <% @post.post_comments.each do |post_comment| %>
          <%# post_user == post_comment.user %>
          <tr>
            <td><b><%= link_to @user.name, user_path(@user.id) %></b>&nbsp&nbsp</td>
            <td><%= simple_format(post_comment.comment) %></td>
            <td>
              <% if user_signed_in? %>
                <% if post_comment.user == current_user %>
                  <%= link_to '削除', post_post_comment_path(@post, post_comment), method: :delete, data: {confirm: "本当に削除しますか？"}, class: "btn btn-danger" %>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </table>
      <!--↓ コメント新規追加欄-->
      <div>
        <%= render 'layouts/error_messages', resource: @post_comment %>
        <!--コメント追記枠-->
        <%= form_with model: @post_comment, url: post_post_comments_path(@post), method: :post do |f| %>
          <%= f.text_area :comment %>
          <%#= f.hidden_field :post_id, value: @post.id %>
          <%= f.submit 'コメントする', class: "btn btn-success" %>
        <% end %>
      </div>
      <!--「投稿を削除」赤ボタン_カレントユーザーの場合のみ-->
      <% if @post.user == current_user %>
        <%= link_to '投稿を削除', root_path, method: :delete, data: {confirm: "本当に削除しますか？"}, class: "btn btn-danger" %>
      <% end %>
    </div>
  </div>
</div>

<script>
  $(document).on('turbolinks:load', function() {
  $(document).ready(function(){
      $('.slider').bxSlider();
    });
 })
</script>